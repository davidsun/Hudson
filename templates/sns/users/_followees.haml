/ Modal
%div{ 'id': 'followeesModal', 'class': 'modal hide fade', 'tabindex': '-1', 'role': 'dialog', 'aria-labelledby': 'followeesLabel', 'aria-hidden': 'true' }
  %div{ 'class': 'modal-header' }
    %h3{ 'id': 'followeesLabel' }
      followees
  %div{ 'class': 'modal-body' }
    - if followees
      %ul.unstyled
        - for followee in followees
          %li
            %a{href:"{% url sns.views.users.show followee.followee.id %}" } 
              {{followee.followee.username}}
            %small.follow-buttons{followed:"{{followee.followed|lower}}", user_id:"{{followee.follower.id}}"}
              - if followee.followee == request.user
              - else
                .btn.btn-small.btn-follow.pull-right.followed.hidden
                  %span.not-hover
                    %i.icon-ok
                    已关注
                  %span.hover.hidden
                    %i.icon-white.icon-remove
                    取消关注
                .btn.btn-primary.btn-small.btn-follow.pull-right.not-followed.hidden
                  %i.icon-white.icon-plus
                  关注
    - else
      .muted 还没有人关注我...
  %div{ 'class': 'modal-footer' }
    %button{ 'class': 'btn', 'data-dismiss': 'modal', 'aria-hidden': 'true' }
      关闭
    :javascript
      function showFollowButton(ele){
        ele = $(ele);
        var user_id = ele.attr("user_id");
        if (ele.attr("followed") == "true"){
          ele.find(".not-followed").addClass("hidden");
          ele.find(".followed").removeClass("hidden");
        } else {
          ele.find(".not-followed").removeClass("hidden");
          ele.find(".followed").addClass("hidden");
        }
        ele.find(".followed").unbind('hover').hover(function(){
          var t = $(this);
          t.find(".not-hover").addClass("hidden");
          t.find(".hover").removeClass("hidden");
          t.addClass("btn-danger");
        }, function(){
          var t = $(this);
          t.find(".not-hover").removeClass("hidden");
          t.find(".hover").addClass("hidden");
          t.removeClass("btn-danger");
        });
        ele.find(".followed").unbind('click').click(function(){
          $.get("/users/" + user_id + "/unfollow");
          ele.attr("followed", "false");
          showFollowButton(ele);
        });
        ele.find(".not-followed").unbind('click').click(function(){
          $.get("/users/" + user_id + "/follow");
          ele.attr("followed", "true");
          showFollowButton(ele);
        });
      }
      $(".follow-buttons").each(function(){ showFollowButton(this); });